{% extends "layouts/base.html" %}

{% block title %} Categories {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

<div style="display: flex; justify-content: center; align-items: flex-end; height: 60vh;">
    <div class="card card-chart" style="max-width: 1900px;height:650px">
        <div class="card-header">
            <h5 class="card-category">Total Sales</h5>
            <h3 class="card-title"><i class="tim-icons icon-bell-55 text-primary"></i> Weekly Dashboard</h3>
        </div>
        <div class="card-body">
            <div class="chart-area">
                <canvas id="ProductSalesChart"></canvas>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-lg-12 text-center mt-5 mb-3">
        <div class="card card-chart mx-auto" style="height: 400px; max-width: 400px;">
            <div class="card-header">
                <h4 class="card-title">Categories</h4>
            </div>
            <div class="card-body d-flex align-items-center justify-content-center" id="categoryContentBox">
                <!-- Content for the category box -->
                <!-- Add your content here -->
            </div>
        </div>
    </div>
</div>


  <style>
     

    /* Styles for horizontal layout of categories */
    #categoryContentBox ul {
        list-style-type: none;
        padding: 0;
        display: flex;
        flex-direction: row;
        justify-content: center;
        flex-wrap: wrap;
        margin-right: 30px;
    }

    #categoryContentBox .asin-checkbox-item {
        margin-right: 30px;
        margin-bottom: 20px;
        justify-content: center;
    }
  </style>

<!-- <div class="d-flex justify-content-center">
    <div class="card card-chart" style="height: 600px; max-width: 1800px;">
        <div class="card-header">
            <h5 class="card-category">Total Sales</h5>
            <h3 class="card-title"><i class="tim-icons icon-bell-55 text-primary"></i> Weekly Dashboard</h3>
        </div>
        <div class="card-body">
            <div class="chart-area">
                <canvas id="ProductSalesChart"></canvas>
            </div>
        </div>
    </div>
</div> -->


<script>
    function fetchAnnualSalesData(asin) {
        const asinData = fetch(`/getAsinData?asin=${asin}`)
            .then(response => response.json())
            .then(asinData => {
                console.log(asinData);

                let asinContentBox = document.getElementById("categoryContentBox");

                // Extracting unique ASINs from jsonData using Set
                let uniqueAsinSet = new Set();
                let asinHtml = "<ul>";

                for (let i = 0; i < asinData.length; i++) {
                    const currentAsin = asinData[i].asin;
                    const category = asinData[i].category;

                    // Check if the ASIN is not in the set, then add it to the HTML
                    if (!uniqueAsinSet.has(category)) {
                        asinHtml += `<li class="asin-checkbox-item"><input type="checkbox" id="categoryContentBox${i}" name="selectedCategory" value="${category}"><label for="selectedCategory${i}">${category}</label></li>`;

                        // Add the ASIN to the set to mark it as added
                        uniqueAsinSet.add(category);
                    }
                }

                asinHtml += "</ul>";

                // Set the content of the categoryContentBox
                asinContentBox.innerHTML = asinHtml;
            })
            .catch(error => {
                console.error('Error fetching or processing data:', error);
            });
    }

    // Example usage
    fetchAnnualSalesData('asin_parameter');
</script>



</script>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}{% endblock javascripts %}
