{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <div class="content">
        <div class="row">
            <div class="col-12">
                <div class="card card-chart">
                    <div class="card-header ">
                        <h5 class="card-category">Sales</h5>
                        <h3 class="card-title"><i class="tim-icons icon-bell-55 text-primary"></i> 763,215</h3>
                    </div>  
                    <div class="card-body">
                        <div class="chart-area">
                            <canvas id="ProductSalesChart"></canvas>
                        </div>
                    </div>    
                    </div>
                </div>
            </div>
        </div>
    </div>

    
        
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script>
    // $(document).ready(function () {
    //     // Javascript method's body can be found in assets/js/demos.js
    //     // demo.initDashboardPageCharts();

    // });
    async function fetchDataAndCreateChart() {
        try {
            const response = await fetch("/search?asin=TLM0101"); // Replace with your API endpoint
            const jsonData = await response.json();
            console.log(jsonData);
            
            let chartLabels = [];
            let chartData = [];

        // Extracting time and value data from jsonData
            for (let i = 0; i < jsonData.length; i++) {
            chartLabels.push(jsonData[i]._time); // Extracting _time property
            chartData.push(jsonData[i]._value); // Extracting _value property
            
        }
        console.log(chartData)
        console.log(chartLabels)

            const gradientChartOptionsConfigurationWithTooltipPurple = {
            maintainAspectRatio: false,
            legend: {
                display: false
            },
            tooltips: {
                backgroundColor: '#f5f5f5',
                titleFontColor: '#333',
                bodyFontColor: '#666',
                bodySpacing: 4,
                xPadding: 12,
                mode: "nearest",
                intersect: 0,
                position: "nearest"
            },
            responsive: true,
            scales: {
                yAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: 'rgba(29,140,248,0.0)',
                    zeroLineColor: "transparent",
                },
                ticks: {
                    suggestedMin: 60,
                    suggestedMax: 125,
                    padding: 20,
                    fontColor: "#9a9a9a"
                }
                }],

                xAxes: [{
                barPercentage: 1.6,
                gridLines: {
                    drawBorder: false,
                    color: 'rgba(225,78,202,0.1)',
                    zeroLineColor: "transparent",
                },
                ticks: {
                    padding: 20,
                    fontColor: "#9a9a9a"
                }
                }]
            }
            
            };

            let ctx = document.getElementById("ProductSalesChart").getContext('2d');

            var gradientStroke = ctx.createLinearGradient(0, 230, 0, 50);

            gradientStroke.addColorStop(1, 'rgba(72,72,176,0.1)');
            gradientStroke.addColorStop(0.4, 'rgba(72,72,176,0.0)');
            gradientStroke.addColorStop(0, 'rgba(119,52,169,0)'); //purple colors
            var config = {
            type: 'line',
            data: {
            labels: chartLabels,
            datasets: [{
                    label: '# of Votes',
                    data: chartData,
                    borderWidth: 1
            }]
                },
            options: gradientChartOptionsConfigurationWithTooltipPurple
            };
            new Chart(ctx, config);

        } catch (error) {
            console.error('Error fetching or processing data:', error);
        }
    } 

    fetchDataAndCreateChart();


    

    // // Arrays to store formatted datasearch_products
    // const labels = [];
    // const dataValues = [];

    // // Extracting data for Chart.js
    // jsonData.forEach(item => {
    //   labels.push(item._time);
    //   dataValues.push(item._value);
    // });

    // fetch(
    //     "/search?asin=TLM0101"
    // ).then(response => console.log(response.json()));
    // const gradientChartOptionsConfigurationWithTooltipPurple = {
    //   maintainAspectRatio: false,
    //   legend: {
    //     display: false
    //   },

    //   tooltips: {
    //     backgroundColor: '#f5f5f5',
    //     titleFontColor: '#333',
    //     bodyFontColor: '#666',
    //     bodySpacing: 4,
    //     xPadding: 12,
    //     mode: "nearest",
    //     intersect: 0,
    //     position: "nearest"
    //   },
    //   responsive: true,
    //   scales: {
    //     yAxes: [{
    //       barPercentage: 1.6,
    //       gridLines: {
    //         drawBorder: false,
    //         color: 'rgba(29,140,248,0.0)',
    //         zeroLineColor: "transparent",
    //       },
    //       ticks: {
    //         suggestedMin: 60,
    //         suggestedMax: 125,
    //         padding: 20,
    //         fontColor: "#9a9a9a"
    //       }
    //     }],

    //     xAxes: [{
    //       barPercentage: 1.6,
    //       gridLines: {
    //         drawBorder: false,
    //         color: 'rgba(225,78,202,0.1)',
    //         zeroLineColor: "transparent",
    //       },
    //       ticks: {
    //         padding: 20,
    //         fontColor: "#9a9a9a"
    //       }
    //     }]
    //   }
    
    // };

    // // var chart_labels = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
    // // var chart_data = [100, 70, 90, 70, 85, 20, 75, 20, 90, 80, 110, 100];


    // let ctx = document.getElementById("ProductSalesChart").getContext('2d');

    // var gradientStroke = ctx.createLinearGradient(0, 230, 0, 50);

    // gradientStroke.addColorStop(1, 'rgba(72,72,176,0.1)');
    // gradientStroke.addColorStop(0.4, 'rgba(72,72,176,0.0)');
    // gradientStroke.addColorStop(0, 'rgba(119,52,169,0)'); //purple colors
    // var config = {
    // type: 'line',
    //  data: {
    //   labels: chart_labels,
    //   datasets: [{
    //     label: '# of Votes',
    //     data: chart_data,
    //     borderWidth: 1
    //   }]
    // },
    // // options: {
    // //   scales: {
    // //     y: {
    // //       beginAtZero: true
    // //     }
    // //   }
    // // }
    // options: gradientChartOptionsConfigurationWithTooltipPurple
    // };
    // new Chart(ctx, config);
    // fetchDataAndCreateChart();
// const ctx = document.getElementById('ProductSalesChart');

//   new Chart(ctx, {
//     type: 'bar',
//     data: {
//       labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
//       datasets: [{
//         label: '# of Votes',
//         data: [12, 19, 3, 5, 2, 3],
//         borderWidth: 1
//       }]
//     },
//     options: {
//       scales: { 
//         y: {
//           beginAtZero: true
//         }
//       }
//     }
//   });
    
</script>




{% endblock javascripts %}


